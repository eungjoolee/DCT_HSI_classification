Computation on CUDA GPU device 0
Split 200 bands into 4 groups and use 4 frequency
Apply KD...
Split 200 bands into 4 groups and use 50 frequency
Image has dimensions 145x145 and 16 channels
Image has dimensions 145x145 and 200 channels
Using existing train/test split...
7374 samples selected (over 10249)
Running an experiment with the he_customized model run 1/1
Using existing train/val split...
{'dataset': 'IndianPines', 'model': 'he_customized', 'folder': './Datasets/', 'cuda': 0, 'runs': 1, 'training_sample': 0.8, 'sampling_mode': 'fixed', 'train_set': './Datasets/IndianPines/train.mat', 'test_set': './Datasets/IndianPines/test.mat', 'val_set': './Datasets/IndianPines/val.mat', 'epoch': 100, 'lr': 0.01, 'class_balancing': False, 'test_stride': 1, 'flip_augmentation': True, 'radiation_augmentation': False, 'mixture_augmentation': False, 'with_exploration': False, 'band_group': 4, 'use_freq': 4, 'use_kernel': 16, 'band_selection': 0, 'selection_mode': 'random', 't_band_group': 4, 't_use_freq': 50, 't_use_kernel': 16, 't_restore': './checkpoints/he_et_al_customized/IndianPines/teacher/2021-04-17_02:09:25.519213_epoch100_0.90_gp_4_fq_50_ch_16.pth', 'kd_alpha': 0.1, 'kd_temp': 20.0, 'n_classes': 17, 'n_bands': 16, 'ignored_labels': [0], 'device': device(type='cuda', index=0), 'n_kernel': 16, 't_n_bands': 200, 'weights': tensor([0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],
       device='cuda:0'), 'patch_size': 7, 'batch_size': 40, 'learning_rate': 0.01, 'scheduler': <torch.optim.lr_scheduler.ReduceLROnPlateau object at 0x7f8b3f52c610>, 'supervision': 'full', 'center_pixel': True}
Network :
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv3d: 1-1                            [-1, 16, 104, 5, 5]       1,600
├─Conv3d: 1-2                            [-1, 16, 104, 5, 5]       272
├─Conv3d: 1-3                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-4                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-5                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-6                            [-1, 16, 104, 5, 5]       272
├─Conv3d: 1-7                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-8                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-9                            [-1, 16, 104, 5, 5]       784
├─Conv3d: 1-10                           [-1, 16, 102, 4, 4]       3,088
├─Dropout: 1-11                          [-1, 512]                 --
├─Linear: 1-12                           [-1, 17]                  8,721
==========================================================================================
Total params: 18,657
Trainable params: 18,657
Non-trainable params: 0
Total mult-adds (M): 22.45
==========================================================================================
Input size (MB): 0.04
Forward/backward pass size (MB): 3.06
Params size (MB): 0.07
Estimated Total Size (MB): 3.17
==========================================================================================
Train (epoch 1/100) [3960/7120 (56%)]	Loss: 1.660440
Train (epoch 2/100) [840/7120 (12%)]	Loss: 1.315181
Train (epoch 2/100) [4840/7120 (68%)]	Loss: 1.224592
Train (epoch 3/100) [1720/7120 (24%)]	Loss: 1.152279
Train (epoch 3/100) [5720/7120 (80%)]	Loss: 1.104428
Train (epoch 4/100) [2600/7120 (37%)]	Loss: 1.068940
Train (epoch 4/100) [6600/7120 (93%)]	Loss: 1.028390
Train (epoch 5/100) [3480/7120 (49%)]	Loss: 0.994403
Train (epoch 6/100) [360/7120 (5%)]	Loss: 0.967400
Train (epoch 6/100) [4360/7120 (61%)]	Loss: 0.934501
Train (epoch 7/100) [1240/7120 (17%)]	Loss: 0.914957
Train (epoch 7/100) [5240/7120 (74%)]	Loss: 0.885417
Train (epoch 8/100) [2120/7120 (30%)]	Loss: 0.890446
Train (epoch 8/100) [6120/7120 (86%)]	Loss: 0.862926
Train (epoch 9/100) [3000/7120 (42%)]	Loss: 0.840385
Train (epoch 9/100) [7000/7120 (98%)]	Loss: 0.842420
Train (epoch 10/100) [3880/7120 (54%)]	Loss: 0.814602
Train (epoch 11/100) [760/7120 (11%)]	Loss: 0.806047
Train (epoch 11/100) [4760/7120 (67%)]	Loss: 0.797993
Train (epoch 12/100) [1640/7120 (23%)]	Loss: 0.767896
Train (epoch 12/100) [5640/7120 (79%)]	Loss: 0.783914
Train (epoch 13/100) [2520/7120 (35%)]	Loss: 0.771978
Train (epoch 13/100) [6520/7120 (92%)]	Loss: 0.740761
Train (epoch 14/100) [3400/7120 (48%)]	Loss: 0.749239
Train (epoch 15/100) [280/7120 (4%)]	Loss: 0.712602
Train (epoch 15/100) [4280/7120 (60%)]	Loss: 0.717646
Train (epoch 16/100) [1160/7120 (16%)]	Loss: 0.717143
Train (epoch 16/100) [5160/7120 (72%)]	Loss: 0.713830
Train (epoch 17/100) [2040/7120 (29%)]	Loss: 0.686489
Train (epoch 17/100) [6040/7120 (85%)]	Loss: 0.685351
Train (epoch 18/100) [2920/7120 (41%)]	Loss: 0.682232
Train (epoch 18/100) [6920/7120 (97%)]	Loss: 0.678285
Train (epoch 19/100) [3800/7120 (53%)]	Loss: 0.677807
Train (epoch 20/100) [680/7120 (10%)]	Loss: 0.655965
Train (epoch 20/100) [4680/7120 (66%)]	Loss: 0.668148
Saving neural network weights in 2021-04-17 15:52:13.535963_epoch20_0.77_gp_4_fq_4_ch_16
Train (epoch 21/100) [1560/7120 (22%)]	Loss: 0.655665
Train (epoch 21/100) [5560/7120 (78%)]	Loss: 0.652873
Train (epoch 22/100) [2440/7120 (34%)]	Loss: 0.649644
Train (epoch 22/100) [6440/7120 (90%)]	Loss: 0.640608
Train (epoch 23/100) [3320/7120 (47%)]	Loss: 0.640842
Train (epoch 24/100) [200/7120 (3%)]	Loss: 0.621426
Train (epoch 24/100) [4200/7120 (59%)]	Loss: 0.618650
Train (epoch 25/100) [1080/7120 (15%)]	Loss: 0.622048
Train (epoch 25/100) [5080/7120 (71%)]	Loss: 0.636476
Train (epoch 26/100) [1960/7120 (28%)]	Loss: 0.601794
Train (epoch 26/100) [5960/7120 (84%)]	Loss: 0.621685
Train (epoch 27/100) [2840/7120 (40%)]	Loss: 0.625282
Train (epoch 27/100) [6840/7120 (96%)]	Loss: 0.594750
Train (epoch 28/100) [3720/7120 (52%)]	Loss: 0.615877
Train (epoch 29/100) [600/7120 (8%)]	Loss: 0.573304
Train (epoch 29/100) [4600/7120 (65%)]	Loss: 0.592722
Train (epoch 30/100) [1480/7120 (21%)]	Loss: 0.581150
Train (epoch 30/100) [5480/7120 (77%)]	Loss: 0.578632
Train (epoch 31/100) [2360/7120 (33%)]	Loss: 0.605059
Train (epoch 31/100) [6360/7120 (89%)]	Loss: 0.591514
Train (epoch 32/100) [3240/7120 (46%)]	Loss: 0.567564
Train (epoch 33/100) [120/7120 (2%)]	Loss: 0.574965
Train (epoch 33/100) [4120/7120 (58%)]	Loss: 0.592934
Train (epoch 34/100) [1000/7120 (14%)]	Loss: 0.559425
Train (epoch 34/100) [5000/7120 (70%)]	Loss: 0.564500
Train (epoch 35/100) [1880/7120 (26%)]	Loss: 0.566740
Train (epoch 35/100) [5880/7120 (83%)]	Loss: 0.558942
Train (epoch 36/100) [2760/7120 (39%)]	Loss: 0.550659
Train (epoch 36/100) [6760/7120 (95%)]	Loss: 0.556289
Train (epoch 37/100) [3640/7120 (51%)]	Loss: 0.555591
Train (epoch 38/100) [520/7120 (7%)]	Loss: 0.552433
Train (epoch 38/100) [4520/7120 (63%)]	Loss: 0.545024
Train (epoch 39/100) [1400/7120 (20%)]	Loss: 0.558072
Train (epoch 39/100) [5400/7120 (76%)]	Loss: 0.555803
Train (epoch 40/100) [2280/7120 (32%)]	Loss: 0.533390
Train (epoch 40/100) [6280/7120 (88%)]	Loss: 0.533174
Saving neural network weights in 2021-04-17 15:52:40.135098_epoch40_0.81_gp_4_fq_4_ch_16
Train (epoch 41/100) [3160/7120 (44%)]	Loss: 0.532717
Train (epoch 42/100) [40/7120 (1%)]	Loss: 0.539444
Train (epoch 42/100) [4040/7120 (57%)]	Loss: 0.542495
Train (epoch 43/100) [920/7120 (13%)]	Loss: 0.538759
Train (epoch 43/100) [4920/7120 (69%)]	Loss: 0.521817
Train (epoch 44/100) [1800/7120 (25%)]	Loss: 0.529152
Train (epoch 44/100) [5800/7120 (81%)]	Loss: 0.531881
Train (epoch 45/100) [2680/7120 (38%)]	Loss: 0.520195
Train (epoch 45/100) [6680/7120 (94%)]	Loss: 0.528536
Train (epoch 46/100) [3560/7120 (50%)]	Loss: 0.525956
Train (epoch 47/100) [440/7120 (6%)]	Loss: 0.524073
Train (epoch 47/100) [4440/7120 (62%)]	Loss: 0.523472
Train (epoch 48/100) [1320/7120 (19%)]	Loss: 0.523533
Train (epoch 48/100) [5320/7120 (75%)]	Loss: 0.526867
Train (epoch 49/100) [2200/7120 (31%)]	Loss: 0.513557
Train (epoch 49/100) [6200/7120 (87%)]	Loss: 0.512830
Train (epoch 50/100) [3080/7120 (43%)]	Loss: 0.490189
Train (epoch 50/100) [5133/5162 (99%)]	Loss: 0.520243
Train (epoch 51/100) [3960/7120 (56%)]	Loss: 0.505390
Train (epoch 52/100) [840/7120 (12%)]	Loss: 0.504950
Train (epoch 52/100) [4840/7120 (68%)]	Loss: 0.498920
Train (epoch 53/100) [1720/7120 (24%)]	Loss: 0.509278
Train (epoch 53/100) [5720/7120 (80%)]	Loss: 0.506110
Train (epoch 54/100) [2600/7120 (37%)]	Loss: 0.487460
Train (epoch 54/100) [6600/7120 (93%)]	Loss: 0.502823
Train (epoch 55/100) [3480/7120 (49%)]	Loss: 0.492770
Train (epoch 56/100) [360/7120 (5%)]	Loss: 0.511037
Train (epoch 56/100) [4360/7120 (61%)]	Loss: 0.508210
Train (epoch 57/100) [1240/7120 (17%)]	Loss: 0.505768
Train (epoch 57/100) [5240/7120 (74%)]	Loss: 0.488368
Train (epoch 58/100) [2120/7120 (30%)]	Loss: 0.489246
Train (epoch 58/100) [6120/7120 (86%)]	Loss: 0.489335
Train (epoch 59/100) [3000/7120 (42%)]	Loss: 0.497297
Train (epoch 59/100) [7000/7120 (98%)]	Loss: 0.489376
Train (epoch 60/100) [3880/7120 (54%)]	Loss: 0.486578
Saving neural network weights in 2021-04-17 15:53:07.871650_epoch60_0.81_gp_4_fq_4_ch_16
Train (epoch 61/100) [760/7120 (11%)]	Loss: 0.497333
Train (epoch 61/100) [4760/7120 (67%)]	Loss: 0.483588
Train (epoch 62/100) [1640/7120 (23%)]	Loss: 0.470014
Train (epoch 62/100) [5640/7120 (79%)]	Loss: 0.488267
Train (epoch 63/100) [2520/7120 (35%)]	Loss: 0.482077
Train (epoch 63/100) [6520/7120 (92%)]	Loss: 0.478825
Train (epoch 64/100) [3400/7120 (48%)]	Loss: 0.486696
Train (epoch 65/100) [280/7120 (4%)]	Loss: 0.466018
Train (epoch 65/100) [4280/7120 (60%)]	Loss: 0.484363
Train (epoch 66/100) [1160/7120 (16%)]	Loss: 0.469049
Train (epoch 66/100) [5160/7120 (72%)]	Loss: 0.473616
Train (epoch 67/100) [2040/7120 (29%)]	Loss: 0.467039
Train (epoch 67/100) [6040/7120 (85%)]	Loss: 0.479744
Train (epoch 68/100) [2920/7120 (41%)]	Loss: 0.468344
Train (epoch 68/100) [6920/7120 (97%)]	Loss: 0.471970
Train (epoch 69/100) [3800/7120 (53%)]	Loss: 0.466941
Train (epoch 70/100) [680/7120 (10%)]	Loss: 0.466268
Train (epoch 70/100) [4680/7120 (66%)]	Loss: 0.460089
Train (epoch 71/100) [1560/7120 (22%)]	Loss: 0.479395
Train (epoch 71/100) [5560/7120 (78%)]	Loss: 0.461353
Train (epoch 72/100) [2440/7120 (34%)]	Loss: 0.464925
Train (epoch 72/100) [6440/7120 (90%)]	Loss: 0.468151
Train (epoch 73/100) [3320/7120 (47%)]	Loss: 0.460881
Train (epoch 74/100) [200/7120 (3%)]	Loss: 0.467255
Train (epoch 74/100) [4200/7120 (59%)]	Loss: 0.457610
Train (epoch 75/100) [1080/7120 (15%)]	Loss: 0.476941
Train (epoch 75/100) [5080/7120 (71%)]	Loss: 0.460900
Train (epoch 76/100) [1960/7120 (28%)]	Loss: 0.470696
Train (epoch 76/100) [5960/7120 (84%)]	Loss: 0.459237
Train (epoch 77/100) [2840/7120 (40%)]	Loss: 0.468936
Train (epoch 77/100) [6840/7120 (96%)]	Loss: 0.468492
Train (epoch 78/100) [3720/7120 (52%)]	Loss: 0.472629
Train (epoch 79/100) [600/7120 (8%)]	Loss: 0.457241
Train (epoch 79/100) [4600/7120 (65%)]	Loss: 0.471539
Train (epoch 80/100) [1480/7120 (21%)]	Loss: 0.435033
Train (epoch 80/100) [5480/7120 (77%)]	Loss: 0.467972
Saving neural network weights in 2021-04-17 15:53:36.945240_epoch80_0.80_gp_4_fq_4_ch_16
Train (epoch 81/100) [2360/7120 (33%)]	Loss: 0.448170
Train (epoch 81/100) [6360/7120 (89%)]	Loss: 0.455057
Train (epoch 82/100) [3240/7120 (46%)]	Loss: 0.452394
Train (epoch 83/100) [120/7120 (2%)]	Loss: 0.460215
Train (epoch 83/100) [4120/7120 (58%)]	Loss: 0.452552
Train (epoch 84/100) [1000/7120 (14%)]	Loss: 0.443807
Train (epoch 84/100) [5000/7120 (70%)]	Loss: 0.442160
Train (epoch 85/100) [1880/7120 (26%)]	Loss: 0.448491
Train (epoch 85/100) [5880/7120 (83%)]	Loss: 0.455902
Train (epoch 86/100) [2760/7120 (39%)]	Loss: 0.452797
Train (epoch 86/100) [6760/7120 (95%)]	Loss: 0.443869
Train (epoch 87/100) [3640/7120 (51%)]	Loss: 0.443303
Train (epoch 88/100) [520/7120 (7%)]	Loss: 0.449419
Train (epoch 88/100) [4520/7120 (63%)]	Loss: 0.451429
Train (epoch 89/100) [1400/7120 (20%)]	Loss: 0.457549
Train (epoch 89/100) [5400/7120 (76%)]	Loss: 0.446884
Train (epoch 90/100) [2280/7120 (32%)]	Loss: 0.434605
Train (epoch 90/100) [6280/7120 (88%)]	Loss: 0.458224
Train (epoch 91/100) [3160/7120 (44%)]	Loss: 0.428204
Train (epoch 92/100) [40/7120 (1%)]	Loss: 0.446453
Train (epoch 92/100) [4040/7120 (57%)]	Loss: 0.450170
Train (epoch 93/100) [920/7120 (13%)]	Loss: 0.429750
Train (epoch 93/100) [4920/7120 (69%)]	Loss: 0.425033
Train (epoch 94/100) [1800/7120 (25%)]	Loss: 0.455105
Train (epoch 94/100) [5800/7120 (81%)]	Loss: 0.449514
Train (epoch 95/100) [2680/7120 (38%)]	Loss: 0.430630
Train (epoch 95/100) [6680/7120 (94%)]	Loss: 0.435715
Train (epoch 96/100) [3560/7120 (50%)]	Loss: 0.431773
Train (epoch 97/100) [440/7120 (6%)]	Loss: 0.424920
Train (epoch 97/100) [4440/7120 (62%)]	Loss: 0.436412
Train (epoch 98/100) [1320/7120 (19%)]	Loss: 0.425297
Train (epoch 98/100) [5320/7120 (75%)]	Loss: 0.446473
Train (epoch 99/100) [2200/7120 (31%)]	Loss: 0.416691
Train (epoch 99/100) [6200/7120 (87%)]	Loss: 0.433515
Train (epoch 100/100) [3080/7120 (43%)]	Loss: 0.442886
Train (epoch 100/100) [5133/5162 (99%)]	Loss: 0.429601
Saving neural network weights in 2021-04-17 15:54:07.121370_epoch100_0.84_gp_4_fq_4_ch_16
Confusion matrix :
[[  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   3   1   0   0   0   0   0   6   0   0   0   0   0   0   0   0]
 [  0   0 251   2   1   0   0   0   0   0  13  16   3   0   0   0   0]
 [ 11   0  15 111   3   0   0   0   0   0   0  23   3   0   0   0   0]
 [  0   0   1   1  46   0   0   0   0   0   0   0   0   0   0   0   0]
 [  7   0   0   0   4  70   2   0   0   0   0   2   1   0  10   1   0]
 [  0   0   0   0   0   0 142   0   0   0   0   0   0   0   0   4   0]
 [  0   0   0   0   0   4   0   0   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  96   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   3   0   0   0]
 [  6   0  10   2   0   1   0   0   0   0 154  16   1   4   0   1   0]
 [ 13   0  10   7   0   1   0   0   0   0  14 443   1   1   0   1   0]
 [  1   0  50   7   1   0   0   0   0   0   7   4  47   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  41   0   0   0]
 [  0   0   0   0   0   6   0   0   0   0   0   0   0   0 240   7   0]
 [ 15   0   0   0   0   1   5   0   0   0   0   0   0   0  11  46   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  19]]---
Accuracy : 83.212%
---
F1 scores :
	Undefined: 0.000
	Alfalfa: 0.462
	Corn-notill: 0.804
	Corn-mintill: 0.750
	Corn: 0.893
	Grass-pasture: 0.778
	Grass-trees: 0.963
	Grass-pasture-mowed: 0.000
	Hay-windrowed: 0.960
	Oats: 0.400
	Soybean-notill: 0.804
	Soybean-mintill: 0.890
	Soybean-clean: 0.537
	Wheat: 0.891
	Woods: 0.934
	Buildings-Grass-Trees-Drives: 0.667
	Stone-Steel-Towers: 1.000
---
Kappa: 0.808

