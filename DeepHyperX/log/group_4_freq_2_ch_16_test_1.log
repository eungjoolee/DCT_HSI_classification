Computation on CUDA GPU device 0
Split 200 bands into 4 groups and use 2 frequency
Image has dimensions 145x145 and 8 channels
Using existing train/test split...
7374 samples selected (over 10249)
Running an experiment with the he_customized model run 1/1
Using existing train/val split...
{'dataset': 'IndianPines', 'model': 'he_customized', 'folder': './Datasets/', 'cuda': 0, 'runs': 1, 'training_sample': 0.8, 'sampling_mode': 'fixed', 'train_set': './Datasets/IndianPines/train.mat', 'test_set': './Datasets/IndianPines/test.mat', 'val_set': './Datasets/IndianPines/val.mat', 'epoch': 100, 'lr': 0.01, 'class_balancing': False, 'test_stride': 1, 'flip_augmentation': True, 'radiation_augmentation': False, 'mixture_augmentation': False, 'with_exploration': False, 'band_group': 4, 'use_freq': 2, 'use_kernel': 16, 'band_selection': 0, 'selection_mode': 'random', 't_band_group': 0, 't_use_freq': 1, 't_use_kernel': 16, 'n_classes': 17, 'n_bands': 8, 'ignored_labels': [0], 'device': device(type='cuda', index=0), 'n_kernel': 16, 'weights': tensor([0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],
       device='cuda:0'), 'patch_size': 7, 'batch_size': 40, 'learning_rate': 0.01, 'scheduler': <torch.optim.lr_scheduler.ReduceLROnPlateau object at 0x7efba4f0b450>, 'supervision': 'full', 'center_pixel': True}
Network :
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv3d: 1-1                            [-1, 16, 3, 5, 5]         736
├─Conv3d: 1-2                            [-1, 16, 3, 5, 5]         272
├─Conv3d: 1-3                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-4                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-5                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-6                            [-1, 16, 3, 5, 5]         272
├─Conv3d: 1-7                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-8                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-9                            [-1, 16, 3, 5, 5]         784
├─Conv3d: 1-10                           [-1, 16, 1, 4, 4]         3,088
├─Dropout: 1-11                          [-1, 256]                 --
├─Linear: 1-12                           [-1, 17]                  4,369
==========================================================================================
Total params: 13,441
Trainable params: 13,441
Non-trainable params: 0
Total mult-adds (M): 0.49
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.08
Params size (MB): 0.05
Estimated Total Size (MB): 0.14
==========================================================================================
Train (epoch 1/100) [3960/7120 (56%)]	Loss: 2.352428
Train (epoch 2/100) [840/7120 (12%)]	Loss: 1.908263
Train (epoch 2/100) [4840/7120 (68%)]	Loss: 1.772767
Train (epoch 3/100) [1720/7120 (24%)]	Loss: 1.668375
Train (epoch 3/100) [5720/7120 (80%)]	Loss: 1.611034
Train (epoch 4/100) [2600/7120 (37%)]	Loss: 1.580307
Train (epoch 4/100) [6600/7120 (93%)]	Loss: 1.546178
Train (epoch 5/100) [3480/7120 (49%)]	Loss: 1.523001
Train (epoch 6/100) [360/7120 (5%)]	Loss: 1.476257
Train (epoch 6/100) [4360/7120 (61%)]	Loss: 1.480286
Train (epoch 7/100) [1240/7120 (17%)]	Loss: 1.495379
Train (epoch 7/100) [5240/7120 (74%)]	Loss: 1.442488
Train (epoch 8/100) [2120/7120 (30%)]	Loss: 1.434073
Train (epoch 8/100) [6120/7120 (86%)]	Loss: 1.441060
Train (epoch 9/100) [3000/7120 (42%)]	Loss: 1.431985
Train (epoch 9/100) [7000/7120 (98%)]	Loss: 1.409603
Train (epoch 10/100) [3880/7120 (54%)]	Loss: 1.406683
Train (epoch 11/100) [760/7120 (11%)]	Loss: 1.385064
Train (epoch 11/100) [4760/7120 (67%)]	Loss: 1.379879
Train (epoch 12/100) [1640/7120 (23%)]	Loss: 1.369081
Train (epoch 12/100) [5640/7120 (79%)]	Loss: 1.381001
Train (epoch 13/100) [2520/7120 (35%)]	Loss: 1.373555
Train (epoch 13/100) [6520/7120 (92%)]	Loss: 1.372962
Train (epoch 14/100) [3400/7120 (48%)]	Loss: 1.345275
Train (epoch 15/100) [280/7120 (4%)]	Loss: 1.360764
Train (epoch 15/100) [4280/7120 (60%)]	Loss: 1.369755
Train (epoch 16/100) [1160/7120 (16%)]	Loss: 1.317694
Train (epoch 16/100) [5160/7120 (72%)]	Loss: 1.350211
Train (epoch 17/100) [2040/7120 (29%)]	Loss: 1.358046
Train (epoch 17/100) [6040/7120 (85%)]	Loss: 1.335194
Train (epoch 18/100) [2920/7120 (41%)]	Loss: 1.327664
Train (epoch 18/100) [6920/7120 (97%)]	Loss: 1.318458
Train (epoch 19/100) [3800/7120 (53%)]	Loss: 1.329427
Train (epoch 20/100) [680/7120 (10%)]	Loss: 1.298409
Train (epoch 20/100) [4680/7120 (66%)]	Loss: 1.308805
Saving neural network weights in 2021-04-17 02:14:47.287270_epoch20_0.52_gp_4_fq_2_ch_16
Train (epoch 21/100) [1560/7120 (22%)]	Loss: 1.306920
Train (epoch 21/100) [5560/7120 (78%)]	Loss: 1.298651
Train (epoch 22/100) [2440/7120 (34%)]	Loss: 1.262178
Train (epoch 22/100) [6440/7120 (90%)]	Loss: 1.269784
Train (epoch 23/100) [3320/7120 (47%)]	Loss: 1.284202
Train (epoch 24/100) [200/7120 (3%)]	Loss: 1.263795
Train (epoch 24/100) [4200/7120 (59%)]	Loss: 1.254080
Train (epoch 25/100) [1080/7120 (15%)]	Loss: 1.221693
Train (epoch 25/100) [5080/7120 (71%)]	Loss: 1.236211
Train (epoch 26/100) [1960/7120 (28%)]	Loss: 1.225136
Train (epoch 26/100) [5960/7120 (84%)]	Loss: 1.213383
Train (epoch 27/100) [2840/7120 (40%)]	Loss: 1.225756
Train (epoch 27/100) [6840/7120 (96%)]	Loss: 1.230029
Train (epoch 28/100) [3720/7120 (52%)]	Loss: 1.217500
Train (epoch 29/100) [600/7120 (8%)]	Loss: 1.183118
Train (epoch 29/100) [4600/7120 (65%)]	Loss: 1.210674
Train (epoch 30/100) [1480/7120 (21%)]	Loss: 1.187364
Train (epoch 30/100) [5480/7120 (77%)]	Loss: 1.181257
Train (epoch 31/100) [2360/7120 (33%)]	Loss: 1.181052
Train (epoch 31/100) [6360/7120 (89%)]	Loss: 1.175613
Train (epoch 32/100) [3240/7120 (46%)]	Loss: 1.173420
Train (epoch 33/100) [120/7120 (2%)]	Loss: 1.178410
Train (epoch 33/100) [4120/7120 (58%)]	Loss: 1.162081
Train (epoch 34/100) [1000/7120 (14%)]	Loss: 1.166128
Train (epoch 34/100) [5000/7120 (70%)]	Loss: 1.156987
Train (epoch 35/100) [1880/7120 (26%)]	Loss: 1.156311
Train (epoch 35/100) [5880/7120 (83%)]	Loss: 1.155391
Train (epoch 36/100) [2760/7120 (39%)]	Loss: 1.153630
Train (epoch 36/100) [6760/7120 (95%)]	Loss: 1.135694
Train (epoch 37/100) [3640/7120 (51%)]	Loss: 1.142795
Train (epoch 38/100) [520/7120 (7%)]	Loss: 1.131442
Train (epoch 38/100) [4520/7120 (63%)]	Loss: 1.128108
Train (epoch 39/100) [1400/7120 (20%)]	Loss: 1.171060
Train (epoch 39/100) [5400/7120 (76%)]	Loss: 1.127429
Train (epoch 40/100) [2280/7120 (32%)]	Loss: 1.127448
Train (epoch 40/100) [6280/7120 (88%)]	Loss: 1.136092
Saving neural network weights in 2021-04-17 02:15:02.620948_epoch40_0.59_gp_4_fq_2_ch_16
Train (epoch 41/100) [3160/7120 (44%)]	Loss: 1.126342
Train (epoch 42/100) [40/7120 (1%)]	Loss: 1.125872
Train (epoch 42/100) [4040/7120 (57%)]	Loss: 1.128791
Train (epoch 43/100) [920/7120 (13%)]	Loss: 1.112052
Train (epoch 43/100) [4920/7120 (69%)]	Loss: 1.116804
Train (epoch 44/100) [1800/7120 (25%)]	Loss: 1.100421
Train (epoch 44/100) [5800/7120 (81%)]	Loss: 1.085637
Train (epoch 45/100) [2680/7120 (38%)]	Loss: 1.106743
Train (epoch 45/100) [6680/7120 (94%)]	Loss: 1.103373
Train (epoch 46/100) [3560/7120 (50%)]	Loss: 1.074669
Train (epoch 47/100) [440/7120 (6%)]	Loss: 1.099226
Train (epoch 47/100) [4440/7120 (62%)]	Loss: 1.083943
Train (epoch 48/100) [1320/7120 (19%)]	Loss: 1.081319
Train (epoch 48/100) [5320/7120 (75%)]	Loss: 1.100824
Train (epoch 49/100) [2200/7120 (31%)]	Loss: 1.056943
Train (epoch 49/100) [6200/7120 (87%)]	Loss: 1.077966
Train (epoch 50/100) [3080/7120 (43%)]	Loss: 1.074988
Train (epoch 50/100) [5133/5162 (99%)]	Loss: 1.064316
Train (epoch 51/100) [3960/7120 (56%)]	Loss: 1.071435
Train (epoch 52/100) [840/7120 (12%)]	Loss: 1.064319
Train (epoch 52/100) [4840/7120 (68%)]	Loss: 1.054651
Train (epoch 53/100) [1720/7120 (24%)]	Loss: 1.056059
Train (epoch 53/100) [5720/7120 (80%)]	Loss: 1.043194
Train (epoch 54/100) [2600/7120 (37%)]	Loss: 1.045950
Train (epoch 54/100) [6600/7120 (93%)]	Loss: 1.044954
Train (epoch 55/100) [3480/7120 (49%)]	Loss: 1.062326
Train (epoch 56/100) [360/7120 (5%)]	Loss: 1.037276
Train (epoch 56/100) [4360/7120 (61%)]	Loss: 1.046966
Train (epoch 57/100) [1240/7120 (17%)]	Loss: 1.026017
Train (epoch 57/100) [5240/7120 (74%)]	Loss: 1.036449
Train (epoch 58/100) [2120/7120 (30%)]	Loss: 1.023774
Train (epoch 58/100) [6120/7120 (86%)]	Loss: 1.004286
Train (epoch 59/100) [3000/7120 (42%)]	Loss: 1.023095
Train (epoch 59/100) [7000/7120 (98%)]	Loss: 1.002170
Train (epoch 60/100) [3880/7120 (54%)]	Loss: 1.018519
Saving neural network weights in 2021-04-17 02:15:18.218214_epoch60_0.63_gp_4_fq_2_ch_16
Train (epoch 61/100) [760/7120 (11%)]	Loss: 1.000818
Train (epoch 61/100) [4760/7120 (67%)]	Loss: 0.981410
Train (epoch 62/100) [1640/7120 (23%)]	Loss: 0.994210
Train (epoch 62/100) [5640/7120 (79%)]	Loss: 0.989836
Train (epoch 63/100) [2520/7120 (35%)]	Loss: 0.977418
Train (epoch 63/100) [6520/7120 (92%)]	Loss: 0.971655
Train (epoch 64/100) [3400/7120 (48%)]	Loss: 0.999245
Train (epoch 65/100) [280/7120 (4%)]	Loss: 0.976596
Train (epoch 65/100) [4280/7120 (60%)]	Loss: 0.980687
Train (epoch 66/100) [1160/7120 (16%)]	Loss: 0.953684
Train (epoch 66/100) [5160/7120 (72%)]	Loss: 0.955905
Train (epoch 67/100) [2040/7120 (29%)]	Loss: 0.955079
Train (epoch 67/100) [6040/7120 (85%)]	Loss: 0.967667
Train (epoch 68/100) [2920/7120 (41%)]	Loss: 0.945748
Train (epoch 68/100) [6920/7120 (97%)]	Loss: 0.958847
Train (epoch 69/100) [3800/7120 (53%)]	Loss: 0.966722
Train (epoch 70/100) [680/7120 (10%)]	Loss: 0.949982
Train (epoch 70/100) [4680/7120 (66%)]	Loss: 0.950202
Train (epoch 71/100) [1560/7120 (22%)]	Loss: 0.930349
Train (epoch 71/100) [5560/7120 (78%)]	Loss: 0.937258
Train (epoch 72/100) [2440/7120 (34%)]	Loss: 0.953109
Train (epoch 72/100) [6440/7120 (90%)]	Loss: 0.940384
Train (epoch 73/100) [3320/7120 (47%)]	Loss: 0.916313
Train (epoch 74/100) [200/7120 (3%)]	Loss: 0.921155
Train (epoch 74/100) [4200/7120 (59%)]	Loss: 0.937821
Train (epoch 75/100) [1080/7120 (15%)]	Loss: 0.944439
Train (epoch 75/100) [5080/7120 (71%)]	Loss: 0.919061
Train (epoch 76/100) [1960/7120 (28%)]	Loss: 0.920252
Train (epoch 76/100) [5960/7120 (84%)]	Loss: 0.946274
Train (epoch 77/100) [2840/7120 (40%)]	Loss: 0.917022
Train (epoch 77/100) [6840/7120 (96%)]	Loss: 0.924433
Train (epoch 78/100) [3720/7120 (52%)]	Loss: 0.922184
Train (epoch 79/100) [600/7120 (8%)]	Loss: 0.911776
Train (epoch 79/100) [4600/7120 (65%)]	Loss: 0.934469
Train (epoch 80/100) [1480/7120 (21%)]	Loss: 0.890590
Train (epoch 80/100) [5480/7120 (77%)]	Loss: 0.901372
Saving neural network weights in 2021-04-17 02:15:34.645799_epoch80_0.66_gp_4_fq_2_ch_16
Train (epoch 81/100) [2360/7120 (33%)]	Loss: 0.928588
Train (epoch 81/100) [6360/7120 (89%)]	Loss: 0.891463
Train (epoch 82/100) [3240/7120 (46%)]	Loss: 0.896514
Train (epoch 83/100) [120/7120 (2%)]	Loss: 0.892827
Train (epoch 83/100) [4120/7120 (58%)]	Loss: 0.911016
Train (epoch 84/100) [1000/7120 (14%)]	Loss: 0.896777
Train (epoch 84/100) [5000/7120 (70%)]	Loss: 0.916036
Train (epoch 85/100) [1880/7120 (26%)]	Loss: 0.873827
Train (epoch 85/100) [5880/7120 (83%)]	Loss: 0.893611
Train (epoch 86/100) [2760/7120 (39%)]	Loss: 0.879044
Train (epoch 86/100) [6760/7120 (95%)]	Loss: 0.900730
Train (epoch 87/100) [3640/7120 (51%)]	Loss: 0.872731
Train (epoch 88/100) [520/7120 (7%)]	Loss: 0.883910
Train (epoch 88/100) [4520/7120 (63%)]	Loss: 0.885603
Train (epoch 89/100) [1400/7120 (20%)]	Loss: 0.886742
Train (epoch 89/100) [5400/7120 (76%)]	Loss: 0.893358
Train (epoch 90/100) [2280/7120 (32%)]	Loss: 0.887263
Train (epoch 90/100) [6280/7120 (88%)]	Loss: 0.878906
Train (epoch 91/100) [3160/7120 (44%)]	Loss: 0.903572
Train (epoch 92/100) [40/7120 (1%)]	Loss: 0.861720
Train (epoch 92/100) [4040/7120 (57%)]	Loss: 0.864172
Train (epoch 93/100) [920/7120 (13%)]	Loss: 0.870385
Train (epoch 93/100) [4920/7120 (69%)]	Loss: 0.872674
Train (epoch 94/100) [1800/7120 (25%)]	Loss: 0.880782
Train (epoch 94/100) [5800/7120 (81%)]	Loss: 0.865999
Train (epoch 95/100) [2680/7120 (38%)]	Loss: 0.863320
Train (epoch 95/100) [6680/7120 (94%)]	Loss: 0.847456
Train (epoch 96/100) [3560/7120 (50%)]	Loss: 0.871122
Train (epoch 97/100) [440/7120 (6%)]	Loss: 0.845845
Train (epoch 97/100) [4440/7120 (62%)]	Loss: 0.867971
Train (epoch 98/100) [1320/7120 (19%)]	Loss: 0.843701
Train (epoch 98/100) [5320/7120 (75%)]	Loss: 0.862839
Train (epoch 99/100) [2200/7120 (31%)]	Loss: 0.869355
Train (epoch 99/100) [6200/7120 (87%)]	Loss: 0.857185
Train (epoch 100/100) [3080/7120 (43%)]	Loss: 0.847548
Train (epoch 100/100) [5133/5162 (99%)]	Loss: 0.845043
Saving neural network weights in 2021-04-17 02:15:51.588970_epoch100_0.64_gp_4_fq_2_ch_16
Confusion matrix :
[[  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   4   0   0   0   6   0   0   0   0   0   0   0   0]
 [  0   0 243   3   0   0   0   0   0   0  13  20   7   0   0   0   0]
 [ 11   0  53  71   0   0   0   0   0   0   0  15  16   0   0   0   0]
 [  0   0  18   0  28   1   0   0   0   0   0   0   1   0   0   0   0]
 [  7   0   0   0   5  19  11   0   7   0   0   0   3   0  45   0   0]
 [  0   0   0   0   0   0 143   0   0   0   0   0   0   0   3   0   0]
 [  0   0   0   0   0   3   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  96   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   3   0   0   0   0   0   0   0   0   0   1   0]
 [  6   0  30   6   6   2   0   0   0   0 116  26   3   0   0   0   0]
 [ 13   0 103  28  14   3   0   0   0   0  27 293  10   0   0   0   0]
 [  1   0  77   1   4   0   0   0   0   0   0   2  33   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  41   0   0   0]
 [  0   0   0   0   0  12   0   0   0   0   0   0   0   0 235   6   0]
 [ 15   0   0   0   0   0   3   0   0   0   0   0   0  13  18  29   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  19]]---
Accuracy : 66.472%
---
F1 scores :
	Undefined: 0.000
	Alfalfa: 0.000
	Corn-notill: 0.600
	Corn-mintill: 0.516
	Corn: 0.514
	Grass-pasture: 0.271
	Grass-trees: 0.944
	Grass-pasture-mowed: 0.000
	Hay-windrowed: 0.923
	Oats: 0.000
	Soybean-notill: 0.661
	Soybean-mintill: 0.692
	Soybean-clean: 0.344
	Wheat: 0.854
	Woods: 0.848
	Buildings-Grass-Trees-Drives: 0.509
	Stone-Steel-Towers: 1.000
---
Kappa: 0.619

